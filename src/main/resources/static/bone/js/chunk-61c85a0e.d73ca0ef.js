(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61c85a0e"],{"0ccb":function(e,t,a){var n=a("50c4"),r=a("1148"),s=a("1d80"),o=Math.ceil,i=function(e){return function(t,a,i){var l,c,u=String(s(t)),d=u.length,p=void 0===i?" ":String(i),f=n(a);return f<=d||""==p?u:(l=f-d,c=r.call(p,o(l/p.length)),c.length>l&&(c=c.slice(0,l)),e?u+c:c+u)}};e.exports={start:i(!1),end:i(!0)}},1148:function(e,t,a){"use strict";var n=a("a691"),r=a("1d80");e.exports="".repeat||function(e){var t=String(r(this)),a="",s=n(e);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(a+=t);return a}},"4d90":function(e,t,a){"use strict";var n=a("23e7"),r=a("0ccb").start,s=a("9a0c");n({target:"String",proto:!0,forced:s},{padStart:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"8c1e":function(e,t,a){"use strict";var n=a("c2f2"),r=a.n(n);r.a},"9a0c":function(e,t,a){var n=a("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(n)},adfb:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"new-case-container shadow",staticStyle:{"box-shadow":"0 0 6px rgba(0, 0, 0, .06)","border-radius":"8px",padding:"1%"}},[a("span",{staticStyle:{color:"#303133","font-size":"25px","margin-left":"20px"}},[e._v(" "+e._s(e.update?"更新病例":"新建病例")+" ")]),a("el-divider",[a("i",{staticClass:"el-icon-tickets"})]),a("el-form",{ref:"newCaseInfo",staticClass:"new-case-form",attrs:{model:e.newCaseInfo,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"患者姓名",prop:"patient"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{type:"text",maxlength:"20","show-word-limit":""},model:{value:e.newCaseInfo.patient,callback:function(t){e.$set(e.newCaseInfo,"patient",t)},expression:"newCaseInfo.patient"}})],1),a("el-form-item",{attrs:{label:"出生年月日",prop:"birthday"}},[a("el-date-picker",{attrs:{value:e.newCaseInfo.birthday,"default-value":e.newCaseInfo.birthday,type:"date",placeholder:"选择日期"},model:{value:e.newCaseInfo.birthday,callback:function(t){e.$set(e.newCaseInfo,"birthday",t)},expression:"newCaseInfo.birthday"}})],1),a("el-form-item",{attrs:{label:"患者性别",prop:"gender"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.newCaseInfo.gender,callback:function(t){e.$set(e.newCaseInfo,"gender",t)},expression:"newCaseInfo.gender"}},[a("el-radio-button",{attrs:{label:"男"}},[e._v("男")]),a("el-radio-button",{attrs:{label:"女"}},[e._v("女")])],1)],1),a("el-form-item",{attrs:{label:"患者身份证号",prop:"idCard"}},[a("el-input",{staticStyle:{width:"240px"},attrs:{type:"text",maxlength:"18","show-word-limit":""},model:{value:e.newCaseInfo.idCard,callback:function(t){e.$set(e.newCaseInfo,"idCard",t)},expression:"newCaseInfo.idCard"}})],1),a("el-form-item",{attrs:{label:"患者手机号",prop:"phone"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{type:"text",maxlength:"11","show-word-limit":""},model:{value:e.newCaseInfo.phone,callback:function(t){e.$set(e.newCaseInfo,"phone",t)},expression:"newCaseInfo.phone"}})],1),a("el-form-item",{attrs:{label:"病例号",prop:"hospitalCaseId"}},[a("el-input",{staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.newCaseInfo.hospitalCaseId,callback:function(t){e.$set(e.newCaseInfo,"hospitalCaseId",t)},expression:"newCaseInfo.hospitalCaseId"}})],1),a("el-form-item",{attrs:{label:"就诊医院科室",prop:"hospital"}},[a("el-input",{staticStyle:{width:"350px"},attrs:{type:"text",maxlength:"50","show-word-limit":""},model:{value:e.newCaseInfo.hospital,callback:function(t){e.$set(e.newCaseInfo,"hospital",t)},expression:"newCaseInfo.hospital"}})],1),a("el-form-item",{attrs:{label:"患侧",prop:"affectedSide"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.newCaseInfo.affectedSide,callback:function(t){e.$set(e.newCaseInfo,"affectedSide",t)},expression:"newCaseInfo.affectedSide"}},[a("el-radio-button",{attrs:{label:"左"}},[e._v("左")]),a("el-radio-button",{attrs:{label:"右"}},[e._v("右")])],1)],1),a("el-form-item",{attrs:{label:"患肢",prop:"affectedLimb"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.newCaseInfo.affectedLimb,callback:function(t){e.$set(e.newCaseInfo,"affectedLimb",t)},expression:"newCaseInfo.affectedLimb"}},[a("el-radio-button",{attrs:{label:"上肢"}},[e._v("上肢")]),a("el-radio-button",{attrs:{label:"下肢"}},[e._v("下肢")]),a("el-radio-button",{attrs:{label:"足踝"}},[e._v("足踝")])],1)],1),a("el-form-item",{attrs:{label:"就诊类型",prop:"caseType"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.newCaseInfo.caseType,callback:function(t){e.$set(e.newCaseInfo,"caseType",t)},expression:"newCaseInfo.caseType"}},[a("el-radio-button",{attrs:{label:"骨折"}},[e._v("骨折")]),a("el-radio-button",{attrs:{label:"畸形"}},[e._v("畸形")])],1)],1),a("el-form-item",{attrs:{label:"诊断",prop:"caseInfo"}},[a("el-input",{staticStyle:{width:"800px"},attrs:{type:"textarea",maxlength:"2000",autosize:{minRows:3,maxRows:15},placeholder:"请输入患者诊断信息","show-word-limit":""},model:{value:e.newCaseInfo.caseInfo,callback:function(t){e.$set(e.newCaseInfo,"caseInfo",t)},expression:"newCaseInfo.caseInfo"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"mark"}},[a("el-input",{staticStyle:{width:"800px"},attrs:{type:"textarea",maxlength:"500",autosize:{minRows:2,maxRows:10},placeholder:"备注(非必填)","show-word-limit":""},model:{value:e.newCaseInfo.mark,callback:function(t){e.$set(e.newCaseInfo,"mark",t)},expression:"newCaseInfo.mark"}})],1),a("el-form-item",{attrs:{label:"术前外观照",prop:"preoperativeAppearance"}},[a("el-image",{staticStyle:{width:"180px",height:"150px",border:"1px dashed #d9d9d9","border-radius":"6px","margin-left":"30px"},attrs:{fit:"cover",src:e.newCaseInfo.preoperativeAppearance,"preview-src-list":[e.newCaseInfo.preoperativeAppearance]}},[a("div",{staticStyle:{"font-size":"30px",color:"#909399",background:"#f5f7fa","justify-content":"center",display:"flex","align-items":"center",height:"100%"},attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])]),a("el-button",{staticStyle:{"margin-left":"2%"},attrs:{type:"success",plain:"",round:"",size:"mini"}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{"justify-content":"center",display:"flex","align-items":"center"},attrs:{action:"","auto-upload":!1,"show-file-list":!1,"on-change":e.preoperativeAppearanceUpload}},[e._v(" 选择图像 ")])],1)],1),a("el-form-item",{attrs:{label:"术前影像",prop:"preoperativeXray"}},[a("el-image",{staticStyle:{width:"180px",height:"150px",border:"1px dashed #d9d9d9","border-radius":"6px","margin-left":"30px"},attrs:{fit:"cover",src:e.newCaseInfo.preoperativeXray,"preview-src-list":[e.newCaseInfo.preoperativeXray]}},[a("div",{staticStyle:{"font-size":"30px",color:"#909399",background:"#f5f7fa","justify-content":"center",display:"flex","align-items":"center",height:"100%"},attrs:{slot:"error"},slot:"error"},[a("i",{staticClass:"el-icon-picture-outline"})])]),a("el-button",{staticStyle:{"margin-left":"2%"},attrs:{type:"success",plain:"",round:"",size:"mini"}},[a("el-upload",{staticClass:"upload-demo",staticStyle:{"justify-content":"center",display:"flex","align-items":"center"},attrs:{action:"","auto-upload":!1,"show-file-list":!1,"on-change":e.preoperativeXrayUpload}},[e._v(" 选择图像 ")])],1)],1),a("el-form-item",{staticStyle:{"margin-left":"36%"}},[a("el-button",{attrs:{type:"success",round:""},on:{click:e.newCase}},[e._v(" "+e._s(e.update?"更新":"新建")+" ")]),a("el-button",{attrs:{type:"warning",round:""},on:{click:e.resetCase}},[e._v("取消")])],1)],1)],1)},r=[],s=(a("99af"),a("b0c0"),a("4d90"),a("d4f4")),o=a("4360"),i={name:"newCase",data:function(){return{update:!1,newCaseInfo:{patient:null,patientAge:null,idCard:null,phone:null,hospitalCaseId:null,preoperativeAppearance:null,preoperativeXray:null,affectedSide:null,affectedLimb:null,caseType:null,gender:null,hospital:null,caseInfo:null,birthday:null,newCaseRet:null,mark:""},rules:{patient:[{required:!0,message:"请输入患者姓名",trigger:"blur"}],patientAge:[{required:!0,message:"请输入患者年龄",trigger:"blur"}],gender:[{required:!0,message:"请选择患者性别",trigger:"blur"}],affectedSide:[{required:!0,message:"请选择患者患侧",trigger:"blur"}],affectedLimb:[{required:!0,message:"请选择患者患肢",trigger:"blur"}],caseType:[{required:!0,message:"请选择患者就诊类型",trigger:"blur"}],hospital:[{required:!0,message:"请选择就诊医院科室",trigger:"blur"}],caseInfo:[{required:!0,message:"请输入诊断信息",trigger:"blur"}]}}},mounted:function(){var e=this.$route.params.caseInfo;this.newCaseInfo.hospital=this.getUserInfo().hospital,null!=e&&(this.newCaseInfo=e,this.update=!0)},methods:{newCase:function(){var e=this;this.$refs["newCaseInfo"].validate((function(t){if(!t)return e.$notify({title:"新建病例",message:"输入参数不完整，请检查输入参数！",type:"warning",duration:2e3}),!1;var a=new Date(e.newCaseInfo.birthday),n=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0"),i=String(a.getHours()).padStart(2,"0"),l=String(a.getMinutes()).padStart(2,"0"),c=String(a.getSeconds()).padStart(2,"0"),u="".concat(n,"-").concat(r,"-").concat(o," ").concat(i,":").concat(l,":").concat(c);e.newCaseInfo.birthday=u,e.update?Object(s["l"])(e.newCaseInfo).then((function(){e.$notify({title:"更新病例",message:"更新患者 "+e.newCaseInfo.patient+" 病例成功！",type:"success",duration:3e3}),e.resetCase()})):Object(s["h"])({patient:e.newCaseInfo.patient}).then((function(t){null!==t.patient?e.$confirm("已存在同名患者: "+t.patient+"  "+t.gender+"  "+t.patientAge+"岁  创建于: "+t.createBy+"  是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["d"])(e.newCaseInfo).then((function(t){e.$notify({title:"新建病例",message:"新建患者 "+e.newCaseInfo.patient+" 病例成功！",type:"success",duration:3e3}),e.newCaseRet=t,e.resetCase()}))})):Object(s["d"])(e.newCaseInfo).then((function(t){e.$notify({title:"新建病例",message:"新建患者 "+e.newCaseInfo.patient+" 病例成功！",type:"success",duration:3e3}),e.newCaseRet=t,e.resetCase()}))}))}))},preoperativeAppearanceUpload:function(e){this.changeUpload(e,"preoperativeAppearance")},preoperativeXrayUpload:function(e){this.changeUpload(e,"preoperativeXray")},changeUpload:function(e,t){var a=this,n=e.size/1024/1024<20;if(!n)return this.$message.error("上传图像大小不能超过 20MB!"),!1;var r=new FormData;r.append("file",e.raw),r.append("caseId","0");var o=this.$loading({lock:!0,text:"上传图像中，请稍候...",background:"rgba(0,0,0,0.5)"});Object(s["n"])(r).then((function(e){a.$notify({title:"上传图像成功",type:"success",duration:3e3}),a.newCaseInfo[t]=e,o.close()})).catch((function(){o.close()}))},resetCase:function(){this.$refs["newCaseInfo"].resetFields(),this.update?this.$router.push("/caseList"):this.$router.push({name:"medicalRecord",params:{case:this.newCaseRet}})},getUserInfo:function(){o["a"].dispatch("user/getInfo");var e={};return e.id=o["a"].getters.id,e.name=o["a"].getters.name,e.hospital=o["a"].getters.hospital,e.phone=o["a"].getters.phone,e.email=o["a"].getters.email,e.role=o["a"].getters.role,e}}},l=i,c=(a("8c1e"),a("2877")),u=Object(c["a"])(l,n,r,!1,null,"4302b0fb",null);t["default"]=u.exports},c2f2:function(e,t,a){},d4f4:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"l",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"m",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"j",(function(){return f})),a.d(t,"i",(function(){return m})),a.d(t,"k",(function(){return h})),a.d(t,"c",(function(){return g})),a.d(t,"n",(function(){return w}));var n=a("b775");function r(e){return Object(n["a"])({url:"/case/newCase",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/case/updateCase",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/case/queryCase",method:"get",params:e})}function i(e){return Object(n["a"])({url:"/case/newChildCaseRecord",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/case/updateChildCaseRecord",method:"post",data:e})}function c(e){return Object(n["a"])({url:"/case/childCaseRecordList",method:"get",params:e})}function u(e){return Object(n["a"])({url:"/case/queryCaseById",method:"get",params:e})}function d(e){return Object(n["a"])({url:"/case/queryCaseByPatient",method:"get",params:e})}function p(e){return Object(n["a"])({url:"/case/childCaseInfo",method:"get",params:e})}function f(e){return Object(n["a"])({url:"/case/recordInitialPose",method:"get",params:e})}function m(e){return Object(n["a"])({url:"/case/recordFinalPose",method:"get",params:e})}function h(e){return Object(n["a"])({url:"/case/recordPose",method:"get",params:e})}function g(e){return Object(n["a"])({url:"/case/deleteChildCaseRecord",method:"delete",data:e})}function w(e){return Object(n["a"])({url:"/case/uploadXRay",headers:{"Content-Type":"multipart/form-data"},method:"post",data:e})}}}]);